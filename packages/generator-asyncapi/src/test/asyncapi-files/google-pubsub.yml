asyncapi: 3.0.0
info:
  title: Google PubSub Service
  version: 1.0.0
  description: A service that publishes messages to Google PubSub

servers:
  gcp:
    host: pubsub.googleapis.com
    pathname: /projects/my-project/topics/
    protocol: googlepubsub

channels:
  order-topic:
    address: order-topic
    messages:
      orderCreated:
        $ref: '#/components/messages/orderCreated'

operations:
  publishOrder:
    action: send
    channel:
      $ref: '#/channels/order-topic'
    messages:
      - $ref: '#/channels/order-topic/messages/orderCreated'

components:
  messages:
    orderCreated:
      bindings:
        googlepubsub:
          attributes:
            eventType: string
            correlationId: string
            source: string
      contentType: application/json
      payload:
        type: object
        required:
          - orderId
          - customerId
        properties:
          orderId:
            type: string
          customerId:
            type: string
          totalAmount:
            type: number
